
<!DOCTYPE html>
<html lang="en">
  <head>
    {% include "events/head.html" %}
  </head>
  <body>
    {% include "boardgames/navbar.html" %}
    <div class="container">
      <!--col-sm-3 col-md-2 col-md-offset-1 sidebar -->
      {% include "home/sidebar.html" %}
      <div class="col-xs-12 col-sm-6 col-md-5">
        <div class="jumbotron">
          {% if event %}
            <h2 class="col-md-offset-3">{{ event.title }}</h2>
            <br>
            <p>Organizer: {{ event.organizer }}<p>
            <br>
            <p>Date: {{ event.event_date }}</p>
            <br>
            <p>Location: {{ event.location }}</p>
            <br>
            {% if event.private_event %}
            <p>This is a private event.</p>
            {% else %}
            <p>This is a public event.</p>
          {% endif %}
          {% else %}
            <p>Event Error - Unable to Display</p>
          {% endif %}

          {% if request.user == event.organizer %}
            <p><a href="{% url "events:createquestion" event_id=event.id %}">Add Question</a></p>
            <p><a href="{% url 'events:editevent' event.id %}">Edit Event</a></p>
            <p><a href="{% url 'events:delete_event' event.id %}"> Delete Event</a></li></p>
          {% endif %}
          <p><a href="{% url 'events:index' %}">Back to Event List</a></p>
        </div><!--jumbotron-->
        <div class="row">
          {% if question %}
          {% for q in question %}
          <div class="col-xs-6 col-lg-4">
            <p class="listitem questions">{{ q.question_text }}
            {% if request.user == event.organizer %}
              <a href="{% url 'events:editquestion' q.id %}"> Edit</a>
              <a href="{% url 'events:deletequestion' q.id %}"> Delete</a><p/>
            {% endif %}
            {% if choice %}
              {% for c in choice %}
                {% if q.id == c.question_id %}
                  <p class="listitem choices">{{ c.choice_text }} | Votes: {{ c.votes }}
                  <form action="{% url 'events:vote' c.id %}" method="post">
                    {% csrf_token %}
                    <input type="radio" name="choice" id="choice{{ forloop.counter }}" value="{{ choice.id }}" />
                    <label for="choice{{ forloop.counter }}">{{ c.choice_text }}</label><br />
                    <input class="btn btn-default btn-xs" type="submit" value="Vote" />
                  </form>
                  {% if request.user == event.organizer %}
                    <a href="{% url 'events:editchoice' c.id %}"> Edit</a>
                    <a href="{% url 'events:deletechoice' c.id %}"> Delete</a></p>
                  {% endif %}
                {% endif %}
              {% endfor %}
            {% endif %}
            {% if request.user == event.organizer %}
              <p><a href="{% url "events:createchoice" question_id=q.id %}">Add Choice</a></p>
            {% endif %}
          </div><!--/.col-xs-6.col-lg-4-->
          {% endfor %}
          {% else %}
            <p>No questions.</p>
          {% endif %}

          {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

        </div><!--/row-->
      </div><!--/col-xs-12 col-sm-6-->

      <div class="col-xs-9 col-sm-6 col-md-4 sidebar-offcanvas" id="sidebar">
        {% if message %}
          <h2 class="subheading">Messages: </h2>
        {% for m in message %}
          <p class="listitem messages"><b>{{ m.text }}</b>
          <p>Date: {{ m.pub_date }} User: {{m.posted_by}}</p>
          {% if request.user == m.posted_by %}
            <a href="{% url 'events:editmessage' m.id %}"> Edit</a>
            <a href="{% url 'events:deletemessage' m.id %}"> Delete</a>
          {% endif %}
          </p>
        {% endfor %}
        {% else %}
          <p>No messages.</p>
        {% endif %}
        <p><a href="{% url "events:createmessage" event_id=event.id %}">Add Message</a></p>
      </div><!--/.sidebar-offcanvas-->
      <div class="col-xs-9 col-sm-6 col-md-3 sidebar-offcanvas">
      <br>
      {% include "events/attendee_manager.html" %}
      </div>
      <hr>

    </div><!--/.container-->
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="../../dist/js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script>
    <script src="offcanvas.js"></script>
    {% include "events/footer.html" %}
  </body>
</html>